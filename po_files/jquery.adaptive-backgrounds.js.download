(function(g){var S="data-ab-color",b="data-ab-parent",z="data-ab-css-background",T="ab-color-found",B={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgb(255,255,255)"],normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};(function(f){"use strict";var n=function(){return document.createElement("canvas").getContext("2d")},A=function(r,a){var t=new Image,u=r.src||r;u.substring(0,5)!=="data:"&&(t.crossOrigin="Anonymous"),t.onload=function(){var i=n("2d");i.drawImage(t,0,0);var l=i.getImageData(0,0,t.width,t.height);a&&a(l.data)},t.src=u},m=function(r){return["rgb(",r,")"].join("")},e=function(r){return r.map(function(a){return m(a.name)})},x=5,v=10,p={};p.colors=function(r,a){a=a||{};var t=a.exclude||[],u=a.paletteSize||v;A(r,function(i){for(var l=r.width*r.height||i.length,c={},o="",h=[],s={dominant:{name:"",count:0},palette:Array.apply(null,new Array(u)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},d=0;l>d;){if(h[0]=i[d],h[1]=i[d+1],h[2]=i[d+2],o=h.join(","),c[o]=o in c?c[o]+1:1,t.indexOf(m(o))===-1){var C=c[o];C>s.dominant.count?(s.dominant.name=o,s.dominant.count=C):s.palette.some(function(k){return C>k.count?(k.name=o,k.count=C,!0):void 0})}d+=4*x}if(a.success){var y=e(s.palette);a.success({dominant:m(s.dominant.name),secondary:y[0],palette:y})}})},f.RGBaster=f.RGBaster||p})(window),g.adaptiveBackground={run:function(f){var n=g.extend({},B,f);g(n.selector).each(function(A,m){var e=g(this),x=function(){var r=v()?p():e[0];RGBaster.colors(r,{paletteSize:20,exclude:n.exclude,success:function(a){e.attr(S,a.dominant),e.trigger(T,{color:a.dominant,palette:a.palette})}})},v=function(){var r=e.attr(z);return typeof r!="undefined"&&r!==!1},p=function(){var r=e.css("background-image"),a=/\(([^)]+)\)/,t=a.exec(r)[1].replace(/"/g,"");return t};e.on(T,function(r,a){var t;n.parent&&e.parents(n.parent).length?t=e.parents(n.parent):e.attr(b)&&e.parents(e.attr(b)).length?t=e.parents(e.attr(b)):v()?t=e:n.parent?t=e.parents(n.parent):t=e.parent(),t.css({backgroundColor:a.color});var u=function(c){var o=c.match(/\d+/g);return(o[0]*299+o[1]*587+o[2]*114)/1e3},i=function(c){return u(c)>=128?n.normalizedTextColors.dark:n.normalizedTextColors.light},l=function(c){return u(c)<=128?n.lumaClasses.dark:n.lumaClasses.light};n.normalizeTextColor&&t.css({color:i(a.color)}),t.addClass(l(a.color)).attr("data-ab-yaq",u(a.color)),n.success&&n.success(e,a)}),x()})}}})(jQuery);
//# sourceMappingURL=/s/files/1/0738/1409/t/71/assets/jquery.adaptive-backgrounds.js.map?v=47736849781706658311628761495
